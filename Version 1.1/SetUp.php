<?php
require_once 'data.php';
require_once 'Functions.php';

$connection = new mysqli($hn, $un, $pw, $db);
if ($connection->connect_error) die($connection->connect_error);

# add auto increment
$query = "CREATE TABLE if not exists Users 
(UsersID SMALLINT NOT NULL AUTO_INCREMENT,
email VARCHAR(255) NOT NULL,
username VARCHAR(32) NOT NULL UNIQUE,
password VARCHAR(32) NOT NULL,
salt1 VARCHAR(10) NOT NULL,
salt2 VARCHAR(10) NOT NULL,
privilege VARCHAR(10) not null,
PRIMARY KEY(UsersID))";

sqlStmt($connection, $query);


$query = "CREATE TABLE if not exists UserMalWare
(UserMalID INT NOT NULL AUTO_INCREMENT,
name VARCHAR(32) NOT NULL UNIQUE,
Sequence MEDIUMBLOB,
type VARCHAR(32) NOT NULL,
user VARCHAR(32) NOT NULL,
approved Boolean default null,
PRIMARY KEY(UserMalID))";

sqlStmt($connection, $query);

$query = "CREATE TABLE if not exists MalWare 
(MalID SMALLINT NOT NULL AUTO_INCREMENT,
name VARCHAR(32) NOT NULL UNIQUE,
Sequence VARCHAR(32) NOT NULL UNIQUE,
admin VARCHAR(32) NOT NULL,
PRIMARY KEY(MalID))";

sqlStmt($connection, $query);

#$result = $connection->query($query);
#if (!$result) die($connection->error);
#$result -> close();

$salt1 = Salter();
$salt2 = Salter();

$username = 'John';
$password = 'Anderson';
$p = 'ADMIN';
$email = 'Email@yahoo.com';
$token = hasher($password, $salt1, $salt2);

add_Users($connection, $email, $username, $token, $salt1, $salt2, $p);

$salt1 = Salter();
$salt2 = Salter();

$username = 'JohnT';
$password = 'AndersonT';

$token = hasher($password, $salt1, $salt2);

add_Users($connection, $email, $username, $token, $salt1, $salt2, $p);

$username = 'JohnA';
$password = 'AndersonA';
$p = 'USER';
$token = hasher($password, $salt1, $salt2);

add_Users($connection, $email, $username, $token, $salt1, $salt2, $p);



mysqli_close($connection);

echo "setup";




?>