<?php
require_once 'data.php';
require_once 'Functions.php';

$connection = new mysqli($hn, $un, $pw, $db);
if ($connection->connect_error) die($connection->connect_error);

# add auto increment
$query = "CREATE TABLE if not exists Admins 
(AdminID SMALLINT NOT NULL AUTO_INCREMENT,
forename VARCHAR(32) NOT NULL,
surname VARCHAR(32) NOT NULL,
username VARCHAR(32) NOT NULL UNIQUE,
password VARCHAR(32) NOT NULL,
salt1 VARCHAR(10) NOT NULL,
salt2 VARCHAR(10) NOT NULL,
PRIMARY KEY(AdminID))";



sqlStmt($connection, $query);

$query = "CREATE TABLE if not exists MalWare 
(MalID SMALLINT NOT NULL AUTO_INCREMENT,
name VARCHAR(32) NOT NULL UNIQUE,
Sequence VARCHAR(100) NOT NULL UNIQUE,
admin VARCHAR(32) NOT NULL,
PRIMARY KEY(MalID))";

sqlStmt($connection, $query);

#$result = $connection->query($query);
#if (!$result) die($connection->error);
#$result -> close();

$salt1 = Salter();
$salt2 = Salter();

$forename = 'John';
$surname = 'Anderson';
$username = 'John';
$password = 'Anderson';

$token = hasher($password, $salt1, $salt2);

add_Admins($connection, $forename, $surname, $username, $token, $salt1, $salt2);

$salt1 = Salter();
$salt2 = Salter();

$forename = 'JohnT';
$surname = 'AndersonT';
$username = 'JohnT';
$password = 'AndersonT';

$token = hasher($password, $salt1, $salt2);

add_Admins($connection, $forename, $surname, $username, $token, $salt1, $salt2);

mysqli_close($connection);

echo "setup";

function add_Admins($connection, $fn, $sn, $un, $pw, $s1, $s2){
	$query = "INSERT INTO Admins(forename, surname, username, password, salt1, salt2) VALUES('$fn', '$sn', '$un', '$pw', '$s1', '$s2')";
	$result = $connection->query($query);
	if (!$result) die($connection->error);
	}



?>